# ObHack: A random map generator for Doom

ObHack is a random map generator for Doom.  This was the state of the art
in random Doom map generation back in 2007; these days, newer generators
are available here:

* http://oblige.sourceforge.net (Last updated in 2017)
* https://github.com/caligari87/ObAddon/

The home page for this generator is here:

* https://samiam.org/slump/

The reason for this branch is to make a small, compact random map
generator for Doom which I can put on a tiny 50-megabyte hockey-rink
shaped business card CD.

## Running this code

On Windows systems, one can run this code by simply entering the 
`ObHack-engine-697` directory and running the supplied `ObHack.exe`
file.

On other operating systems, read the section “[How to 
compile](#how-to-compile)” below.

## What this is

ObHack is my name for some modifications Fritz and myself have made
to Oblige, a random map generator for the original Doom, Doom 2, and
Heretic. It is name thusly because it is a hacked Oblige, and as a tribute
to the ObHacks posted to the once-great Usenet newsgroup alt.hackers.

ObHack is a fork of version 2 of Oblige (Oblige 0.81-0.97). It has the
following features that Oblige2 does not have:

* Real secret areas that take work to find
* Improved random number generator which allows arbitrary English or 
  Spanish text to be the seed, resulting in a nearly infinite number of 
  possible seeds
* New modes: Single Player + Deathmatch, Deathmatch without exits, and 
  Capture the Flag
* Progressive level size: Levels get bigger as one gets to higher levels 
  in the wad
* Enclosures and variable room sizes
* Adjustable light level
* Tiny and gigantic level sizes
* Option to have swarms or even more mosters
* Monster traps are back (removed in Oblige 0.94)
* Boss levels now have boss monsters in them
* Choice of player starting weapon
* More texture packs, including contributions from Mr. Chris
* Deathmatch starts in single player maps
* And other features not listed here 

## Determinism: About 95% there

ObHack, has, until recently, had issues with making completely different 
maps when given the same parameters.  I have updated the code to remove
about 95% of the problems.

If I run the ObHack program with the same seed and parameters, I will
*sometimes* get a given .wad file; multiple invocations will *sometimes* 
give me a file with the same size and exact same contents.

The code which makes the binary `.wad` file from a given generated map
is non-deterministic; I have verified this by having the code instead
generate `.txt` files (some old debug code which Andrew put there) and
verify that all of the files are the same with a given seed.

In about 5% of the generated maps, some non-deterministic code is run.
It is too deep of a “rabbit hole” for me to figure out exactly why this
happens, so I have instead set it up so that, for `MAP06`, we change
the numbers generated by the random number generator (by adding 1234
“empty” runs of the generator) so that the 32-map megawads generated
for Doom2 (actually, FreeDoom) maps are the same if the seed is either
`1FreeDoom1` or `2FreeDoom1` and the default ObHack parameters are 
used.

## How to compile

These are the files needed to make the Win32 binary of ObHack.  To compile, 
you will need to install both MinGW-3.1.0-1 and MSYS-1.0.10.  Once you do 
that, do something like this:

```
export FLAGS=-Os
export CFLAGS=-Os
cd fltk-1.1.9
./configure
make
cd ..
cd zlib-1.2.3
./configure
make
cd ..
cd glbsp-2.24-source
# You may have to edit the makefile
make
cd ..
cd ObHack-engine-*
cd gui
# You may have to edit the Makefile
make
```

MinGW and MSYS install directions are here:

http://samiam.org/blog/old-200903-mingw-310-1-last-real-mingw-release.html

Note that that version of MinGW does not run in Windows 10.
